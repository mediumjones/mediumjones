<!doctype html>

<title>Codee Sans Mono</title>
<meta charset="utf-8"/>
<link rel="stylesheet" href="css/codemirror.css">
<link rel="stylesheet" href="css/theme/base16-dark.css">

<script src="js/codemirror.js"></script>
<script src="js/mode/css.js"></script>
<script src="js/mode/htmlmixed.js"></script>
<script src="js/mode/javascript.js"></script>
<script src="js/mode/xml.js"></script>
<script src="addon/selection/active-line.js"></script>
<script src="addon/edit/matchbrackets.js"></script>

<style type=text/css>
  article {
    height: 100%;
  }
  .editor {
    width: 50%;
    height: 100%;
    display: block;
    border-right: 1px solid black;
    overflow: hidden;
  }

  iframe {
    width: 50%;
    display: block;
    height: 100%;
    border: none;
  }
</style>

<article>
  <textarea class="editor" id="code" name="code">
<!doctype html>
<html>
  <head>
    <meta charset=utf-8>
    <title>HTML5 canvas demo</title>
    <style>p {font-family: monospace;}</style>
  </head>
  <body>
    <h1>Codee Sans Mono</h1>
    <p>cool beans</p>
  </body>
</html>
  </textarea>
  
  <iframe id=preview>
  </iframe>

  <script>
    var delay;
    // Initialize CodeMirror editor with an html5 canvas preveiew
    var editor = CodeMirror.fromTextArea(document.getElementById('code'), {
      mode: 'text/html',
      lineNumbers: true,
      styleActiveLine: true,
      matchBrackets: true,
      indentUnit: 4,
      theme: "base16-dark"
    });
    editor.on("change", function() {
      clearTimeout(delay);
      delay = setTimeout(updatePreview, 300);
    });
    
    function updatePreview() {
      var previewFrame = document.getElementById('preview');
      var preview =  previewFrame.contentDocument ||  previewFrame.contentWindow.document;
      preview.open();
      preview.write(editor.getValue());
      preview.close();
    }
    setTimeout(updatePreview, 300);
  </script>
</article>